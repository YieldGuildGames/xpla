# This workflow will do a clean install of node dependencies, build the source code and run tests across different versions of node
# For more information see: https://help.github.com/actions/language-and-framework-guides/using-nodejs-with-github-actions

name: Push xpla docker image

env:
  PROJECT: yggproj

on: push
jobs:
  xpla-docker:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v3
      - name: Set up Cloud SDK
        uses: google-github-actions/setup-gcloud@v0
        with:
          #version: "290.0.1" # optional, if not provided -> resolves to latest version
          service_account_key: ${{ secrets.GCLOUD_CDBOT_SERVICE_ACCOUNT }}
          project_id: yggproj
      - name: Configure Docker to use gcloud command-line
        run: gcloud --quiet auth configure-docker

      - run: echo "MONTH=$(date +%m)" >> $GITHUB_ENV
      - name: Push docker image
        run: make push
